!function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function t(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var o,n,r=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s}function i(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(t(arguments[i]));return e}var o,n=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var i=this;if(e&&t&&"function"==typeof t){this.on(e,(function o(n){t(n),i.off(e,o)}))}},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var i=this._hooks[e].indexOf(t);-1!==i&&this._hooks[e].splice(i,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,i){if(i){if(!e)return;-1!==this._cache.indexOf(i)?this._emit(e,t):(this._hooksCache.hasOwnProperty(i)||(this._hooksCache[i]={}),this._hooksCache[i].hasOwnProperty(e)||(this._hooksCache[i][e]=[]),this._hooksCache[i][e].push(t))}else this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&i(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),r=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},s=function(e){return Array.isArray(e)},a=(o=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return o+=1}),c=function(e){return function(e,t,i){if("string"==typeof e&&"number"==typeof t&&"number"==typeof i){var o,n=[];i=i<=25?i:i%25;var r=String.fromCharCode(i+97);o=e.split(r);for(var s=0;s<o.length;s++){var a=parseInt(o[s],i);a=1*a^t;var c=String.fromCharCode(a);n.push(c)}return n.join("")}}(e,64,25)},l=function(e){!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},h=function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach((function(t){void 0!==document[t]&&(e=1)})),e},u=function(e){var t=document.createElement("a");return t.href=e,t},p=function(e){var t={};try{var i=u(e).search;(i=i.slice(1)).split("&").forEach((function(e){var i,o,n=e.split("=");n.length&&(i=n[0],o=n[1]);try{t[i]=decodeURIComponent(void 0===o?"":o)}catch(e){t[i]=o}}))}catch(e){}return t};var d=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){var i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var o in i)t[o]=i[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(o){function n(){}function r(t,i,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},n.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(i);/^[\{\[]/.test(s)&&(i=s)}catch(e){}i=o.write?o.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,!0!==r[c]&&(a+="="+r[c].split(";")[0]));return document.cookie=t+"="+i+a}}function s(e,i){if("undefined"!=typeof document){for(var n={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var a=r[s].split("="),c=a.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(a[0]);if(c=(o.read||o)(c,l)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(n[l]=c,e===l)break}catch(e){}}return e?n[e]:n}}return n.set=r,n.get=function(e){return s(e,!1)},n.getJSON=function(e){return s(e,!0)},n.remove=function(t,i){r(t,"",e(i,{expires:-1}))},n.defaults={},n.withConverter=i,n}((function(){}))},e.exports=i()})),f=function(e,t){try{return d.get(e)}catch(e){return""}},g=function(e,t,i,o){try{var n=o||document.domain,r=+new Date+(i||6048e5);d.set(e,t,{expires:new Date(r),path:"/",domain:n})}catch(e){}},m=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return f(e)},e.prototype.setCookie=function(e,t,i,o){g(e,t,i,o)},e}();var _={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||{}}catch(e){}return{}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return f(e)},setCookie:function(e,t,i,o){g(e,t,i,o)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},v={getItem:function(e){try{var t=sessionStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||{}}catch(e){}return{}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return f(e)},setCookie:function(e,t,i,o){g(e,t,i,o)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},y=function(){function e(e,t){this._storage=t&&"session"===t?v:!e&&_.isSupportLS?_:new m}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,i,o){this._storage.setCookie(e,t,i,o)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),b=function(){function e(e,t,i){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=i}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,i=document.referrer,o=i?u(i).hostname:"",n=p(window.location.href),r=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(e,t,i,o){var n=new y(!1,"session"),r=e?"_$utm_from_url_"+e:"_$utm_from_url",s={},a=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],c={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var l=!1;for(var h in c)c[h]&&(-1!==a.indexOf(h)?(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data[h]=c[h]):s[h]=c[h],l=!0);l&&n.setItem(r,"1"),n.getItem(r)&&(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data.$utm_from_url=1)}catch(e){return c}return s}(this.appid,n,this.domain,this.cookie_expire);var s=this.browser(),a=this.os();return{browser:s.browser,browser_version:s.browser_version,platform:r,os_name:a.os_name,os_version:a.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(a.os_name),language:t,referrer:i,referrer_host:o,utm:this.utm,latest_data:this.last(i,o)}},e.prototype.last=function(e,t){var i="",o="",n="",r=location.hostname,s=!1;if(e&&t&&r!==t){i=e,o=t,s=!0;var a=p(e);a.keyword&&(n=a.keyword)}return{$latest_referrer:i,$latest_referrer_host:o,$latest_search_keyword:n,isLast:s}},e.prototype.browser=function(){var e,t,i="",o=""+parseFloat(this.appVersion),n=this.userAgent;return-1!==n.indexOf("Edge")||-1!==n.indexOf("Edg")?(i="Microsoft Edge",-1!==n.indexOf("Edge")?(e=n.indexOf("Edge"),o=n.substring(e+5)):(e=n.indexOf("Edg"),o=n.substring(e+4))):-1!==(e=n.indexOf("MSIE"))?(i="Microsoft Internet Explorer",o=n.substring(e+5)):-1!==(e=n.indexOf("Lark"))?(i="Lark",o=n.substring(e+5,e+11)):-1!==n.indexOf("Chrome")?-1!==(e=n.indexOf("TTWebView"))?(i="TTWebView",o=n.substring(e+10,e+23)):(-1!==(e=n.indexOf("Chrome"))||-1!==(e=n.indexOf("Chrome")))&&(i="Chrome",o=n.substring(e+7)):-1!==n.indexOf("Safari")?-1!==(e=n.indexOf("Safari"))&&(i="Safari",o=n.substring(e+7),-1!==(e=n.indexOf("Version"))&&(o=n.substring(e+8))):-1!==(e=n.indexOf("Firefox"))&&(i="Firefox",o=n.substring(e+8)),-1!==(t=o.indexOf(";"))&&(o=o.substring(0,t)),-1!==(t=o.indexOf(" "))&&(o=o.substring(0,t)),-1!==(t=o.indexOf(")"))&&(o=o.substring(0,t)),{browser:i,browser_version:o}},e.prototype.os=function(){for(var e="",t="",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"ChromeOS",r:/CrOS/},{s:"Linux",r:/(Linux|X11)/},{s:"Sun OS",r:/SunOS/}],o=0;o<i.length;o++){var n=i[o];if(n.r.test(this.userAgent)){"Mac OS X"===(e=n.s)&&this.isNewIpad()&&(e="iOS");break}}var r=function(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""},s=function(e,t){var i=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return i?i.slice(1)[0]:""};/Windows/.test(e)&&(t=r(/Windows (.*)/,e),e="windows");var a,c;switch(e){case"Mac OS X":t=s("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":a=this.userAgent,(c=r(/Android ([\.\_\d]+)/,a))||(c=r(/Android\/([\.\_\d]+)/,a)),t=c,e="android";break;case"iOS":t=this.isNewIpad()?s("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios";break;case"chromeOS":var l=this.userAgent.indexOf("x86_64");t=this.userAgent.substring(l+7,l+16)}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var i=navigator.userAgent.replace("Mozilla/5.0 (",""),o=i.indexOf(";");t=i.slice(0,o)}}catch(e){return t.trim()}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),E={sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},S={va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"};var w,k,D={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z21z1ez4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z49z23z21z1cz18z21z22z4ez18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",ie2:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z1gz1cz4ez4az22z1gz1iz22z1mz1iz25z4az1cz23"},T={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az22z1gz1iz22z1mz1iz25z4az23z21",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az22z1gz1iz22z1mz1iz24z4az23z21",ie:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z1gz1cz4az22z1gz1iz22z1mz1iz25z4az1cz23",ie2:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z1gz1cz4ez4az22z1gz1iz22z1mz1iz25z4az1cz23"};!function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.DestoryInstance="destory-instance",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report",e.VisualCollectReady="visual-collect-ready",e.VisualApiReady="visual-api-ready",e.VisualApiUpdate="visual-api-update"}(w||(w={})),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(k||(k={}));var z,A=w,G=void 0,M=(new Date).getTimezoneOffset(),R=parseInt(""+-M/60,10),C=60*M,x=function(){function t(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var i=new b(t.app_id,t.cookie_domain||"",t.cookie_expire||6048e5).init(),o="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new y(!1,"session"),this.localStorage=new y(!1,"local"),this.channelUrl="tcpy"===t.channel_type||"ttp"===t.channel_type?{WEBID_URL:"/v1/user/webid",TOB_URL:"",REPORT_URL:"/v1/list"}:{WEBID_URL:"/webid",TOB_URL:"/tobid",REPORT_URL:"/list"},t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var n=this.localStorage.getItem(o);n&&1==n?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(o,"1")),this.envInfo={user:{user_unique_id:G,user_type:G,user_id:G,user_is_auth:G,user_is_login:G,device_id:G,web_id:G,ip_addr_id:G,user_unique_id_type:G},header:{app_id:G,app_name:G,app_install_id:G,install_id:G,app_package:G,app_channel:G,app_version:G,ab_version:G,os_name:i.os_name,os_version:i.os_version,device_model:i.device_model,ab_client:G,traffic_type:G,client_ip:G,device_brand:G,os_api:G,access:G,language:i.language,region:G,app_language:G,app_region:G,creative_id:i.utm.creative_id,ad_id:i.utm.ad_id,campaign_id:i.utm.campaign_id,log_type:G,rnd:G,platform:i.platform,sdk_version:"5.3.1_oversea",sdk_lib:"js",province:G,city:G,timezone:R,tz_offset:C,tz_name:G,sim_region:G,carrier:G,resolution:i.screen_width+"x"+i.screen_height,browser:i.browser,browser_version:i.browser_version,referrer:i.referrer,referrer_host:i.referrer_host,width:i.screen_width,height:i.screen_height,screen_width:i.screen_width,screen_height:i.screen_height,utm_term:i.utm.utm_term,utm_content:i.utm.utm_content,utm_source:i.utm.utm_source,utm_medium:i.utm.utm_medium,utm_campaign:i.utm.utm_campaign,tracer_data:JSON.stringify(i.utm.tracer_data),custom:{}}},this.ab_version="",this.ab_uuid_cache={},this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(i),this.initDomain(),this.initABData()}return t.prototype.initDomain=function(e){var t=this.initConfig.channel_domain;if(t)this.domain=t;else{var i=e||this.initConfig.channel,o=this.initConfig&&this.initConfig.channel_type?"tcpy"===this.initConfig.channel_type?D[i]:T[i]:E[i];o||(console.warn("current channel: "+i+" is not exist, use va instead, please check!!!!"),o=E.sg),this.domain=c(o)}},t.prototype.setDomain=function(e){this.customDomain=!0,this.domain=e},t.prototype.getDomain=function(e){return this.customDomain||e&&this.initDomain(e),this.domain},t.prototype.initABData=function(){var e,t="__tea_sdk_ab_version_"+this.initConfig.app_id;e=this.localStorage.getItem(t),this.setAbCache(e)},t.prototype.setAbCache=function(e){this.ab_cache=e},t.prototype.getAbCache=function(){return this.ab_cache},t.prototype.clearAbCache=function(){this.ab_cache={},this.ab_version=""},t.prototype.setAbVersion=function(e){this.ab_version=e},t.prototype.getAbVersion=function(){return this.ab_version},t.prototype.setAbUuidCache=function(e,t){var i=t||this.envInfo.user.user_unique_id;this.ab_uuid_cache[""+i]||(this.ab_uuid_cache[""+i]=[]),-1===this.ab_uuid_cache[""+i].indexOf(e)&&this.ab_uuid_cache[""+i].push(e)},t.prototype.getAbUuidCache=function(e){return this.ab_uuid_cache[""+e]},t.prototype.getUrl=function(e){var t="";switch(e){case"event":t=this.channelUrl.REPORT_URL;break;case"webid":t=this.channelUrl.WEBID_URL;break;case"tobid":t=this.channelUrl.TOB_URL}var i="";return this.initConfig.caller&&(i="?sdk_version=5.3.1_oversea&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+i},t.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},t.prototype.setAppid=function(e){this.envInfo.header.app_id=e},t.prototype.set=function(t){var i=this;Object.keys(t).forEach((function(o){if(void 0!==t[o]&&null!==t[o]||i.delete(o),"traffic_type"===o&&i.isLast&&(i.envInfo.header.custom.$latest_traffic_source_type=t[o]),"evtParams"===o)i.evtParams=e(e({},i.evtParams||{}),t.evtParams||{});else if("_staging_flag"===o)i.evtParams=e(e({},i.evtParams||{}),{_staging_flag:t._staging_flag});else if("reportErrorCallback"===o&&"function"==typeof t[o])i.reportErrorCallback=t[o];else{var n="",r="";if(o.indexOf(".")>-1){var s=o.split(".");n=s[0],r=s[1]}n?"user"===n||"header"===n?i.envInfo[n][r]=t[o]:i.envInfo.header.custom[r]=t[o]:Object.hasOwnProperty.call(i.envInfo.user,o)?["user_type","ip_addr_id"].indexOf(o)>-1?i.envInfo.user[o]=t[o]?Number(t[o]):t[o]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(o)>-1?i.envInfo.user[o]=t[o]?String(t[o]):t[o]:["user_is_auth","user_is_login"].indexOf(o)>-1?i.envInfo.user[o]=Boolean(t[o]):"device_id"===o&&(i.envInfo.user[o]=t[o]):Object.hasOwnProperty.call(i.envInfo.header,o)?i.envInfo.header[o]=t[o]:i.envInfo.header.custom[o]=t[o]}}))},t.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error "),this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},t.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var i=Object.assign(e,t);this.storage.setItem(this.configKey,i)}}catch(e){console.log("setStore error"),this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},t.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"}),null}},t.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"}),console.log("delete error")}},t}(),I=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[Tea instance: "+this.name+"] "+e)},e.prototype.warn=function(e){this.isLog&&console.warn("%c %s","color: #4D1B00; background-color: #FF7D00;","[Tea instance: "+this.name+"] "+e)},e.prototype.error=function(e){this.isLog&&console.error("%c %s","color: #FFF; background-color: #F53F3F;","[Tea instance: "+this.name+"] "+e)},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),O=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var t=window.navigator.userAgent;if(!t)return!0;var i=!1;return this.spiderBot.forEach((function(e){-1!==t.indexOf(e)&&(i=!0)})),i},e}(),B=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1))}catch(e){return console.log("AppLogBridge is not inject"),!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,i){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){console.log("AppLogBridge is started? : "+e),e?t(!0):i(!1)})):i(!1)}catch(e){console.log("AppLogBridge, error:"+JSON.stringify(e.stack)),i(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e)),console.log("change bridge appid, event report with appid: "+e)}catch(e){console.error("setNativeAppId error")}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(i){"user_unique_id"===i?t.setUserUniqueId(e[i]):e[i]?t.addHeaderInfo(i,e[i]):t.removeHeaderInfo(i)}))}catch(e){console.error("setConfig error")}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){console.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){console.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){console.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){console.error("removeHeaderInfo error")}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge report success",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){console.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){console.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){console.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){console.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){console.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){console.error("profileAppend error")}},e}(),U=function(){function t(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return t.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.cacheStorgae=new y(!0),this.localStorage=new y(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=t.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.collect.on(A.Ready,(function(){i.reportAll(!1)})),this.collect.on(A.ConfigDomain,(function(){i.reportUrl=i.configManager.getUrl("event")})),this.collect.on(A.Event,(function(e){i.event(e)})),this.collect.on(A.BeconEvent,(function(e){i.beconEvent(e)})),this.collect.on(A.CleanEvents,(function(){i.reportAll(!1)})),this.linster()},t.prototype.linster=function(){var e=this;window.addEventListener("unload",(function(){e.reportAll(!0)}),!1),l((function(){e.reportAll(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.reportAll(!0)}),!1)},t.prototype.reportAll=function(e){this.report(e),this.reportBecon()},t.prototype.event=function(e){var t=this;if(!this.collect.destroy&&!this.collect.sdkStop)try{var o=i(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,o),this.reportTimeout&&clearTimeout(this.reportTimeout),o.length>=this.maxReport)this.report(!1);else{var n=this.reportTime;this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),n)}}catch(e){this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},t.prototype.beconEvent=function(e){if(!this.collect.destroy&&!this.collect.sdkStop){var t=i(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))}},t.prototype.reportBecon=function(){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},t.prototype.report=function(e){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},t.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var i=0;i<e.length;i+=this.eventLimit){var o;o=e.slice(i,i+this.eventLimit);var n=this.split(this.merge(o));this.send(n,t)}else{n=this.split(this.merge(e));this.send(n,t)}},t.prototype.handleRefer=function(){var e="";try{if(this.config.spa||this.config.autotrack){var t=this.localStorage.getItem(this.refer_key)||{};e=t.routeChange?t.refer_key:this.configManager.get("referrer")}else e=this.configManager.get("referrer")}catch(t){e=document.referrer}return e},t.prototype.merge=function(t,i){var o=this,n=this.configManager.get(),r=n.header,s=n.user;r.custom=JSON.stringify(r.custom),r.referrer=this.handleRefer();var a=this.configManager.get("evtParams"),c=this.configManager.get("user_unique_id_type"),l=[];try{var h=t.filter((function(t){try{Object.keys(a).length&&!i&&(t.params=e(e({},a),t.params)),c&&(t.params.$user_unique_id_type=c);var n=o.configManager.getAbCache(),r=s[o.config.ab_user_mode]||s.user_unique_id,l=o.configManager.getAbUuidCache(r);if(n&&n.uuid&&n.uuid===r){var h=o.configManager.getAbVersion();if(o.config.enable_ab_uuid){if(l&&l.length){var u=l.join(",");h&&h.includes(u)&&(t.ab_sdk_version=h)}}else h&&(t.ab_sdk_version=h)}return t.session_id=o.collect.sessionManager.getSessionId(),t.params=JSON.stringify(t.params),t}catch(e){return console.warn("filter merge event: "+(t&&t.event)+" error, pls check",e&&e.message),o.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Merge Event Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"}),!1}})),u=JSON.parse(JSON.stringify({events:h,user:s,header:r}));u.local_time=Math.floor(Date.now()/1e3),u.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,u.verbose=1,l.push(u)}catch(e){console.warn("event merge error, pls check",e&&e.message)}return l},t.prototype.split=function(e){return e=e.map((function(e){var t=[];return t.push(e),t}))},t.prototype.send=function(e,t){var i=this;e.length&&(this.config.disable_track_event||e.forEach((function(e){try{var o=JSON.parse(JSON.stringify(e));i.config.filter&&((o=i.config.filter(o))||console.warn("filter must return data !!")),i.collect.eventFilter&&o&&((o=i.collect.eventFilter(o))||console.warn("filterEvent api must return data !!"));var n=o||e,r=JSON.parse(JSON.stringify(n));if(!n.length)return;var s=!0;if(n.forEach((function(e){e.events.length||(s=!1)})),!s)return;i.collect.emit(A.SubmitBefore,n),i.collect.requestManager.useRequest({url:i.reportUrl,data:n,success:function(e,t){e&&0!==e.e?(i.collect.emit(A.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),i.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_EVENT,info:"Event Report Fail",time:Date.now(),data:r,code:e.e,failType:"event data error",status:"fail"})):(i.collect.emit(A.SubmitScuess,{eventData:t,res:e}),i.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_EVENT,info:"Event Report Success",time:Date.now(),data:r,code:200,status:"success"}))},fail:function(e,t){i.configManager.get("reportErrorCallback")(e,t),i.collect.emit(A.SubmitError,{type:"f_net",eventData:e,errorCode:t}),i.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_EVENT,info:"Event Report Network Fail",time:Date.now(),data:r,code:t,failType:"network error",status:"fail"})},timeout:i.timeout,useBeacon:!i.config.disable_sendbeacon&&t,withCredentials:i.enable_ttwebid}),i.collect.emit(A.SubmitAfter,n)}catch(e){console.warn("something error, "+JSON.stringify(e.stack)),i.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Report Event Something Error",level:"error",time:Date.now(),data:e.message})}})))},t}(),L=function(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)},N=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new y(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(A.ConfigUuid,(function(e){i.setUuid(e)})),this.collect.on(A.ConfigWebId,(function(e){i.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;this.cacheToken=this.storage.getItem(this.tokenKey)||{},this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(A.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(A.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:L(),user_unique_id:this.configManager.get("user_unique_id")||L()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=p(window.location.href);return!(!t||!t.Web_ID)&&(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),!0)}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),i={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Fetch WebID Request",logType:"fetch",level:"info",time:Date.now(),data:i});var o=L();this.collect.requestManager.useRequest({url:t,data:i,success:function(t){var i;t&&0===t.e?(i=t.web_id,e.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Fetch WebID Request Success",logType:"fetch",level:"info",time:Date.now(),data:t})):(i=o,e.collect.configManager.set({localWebId:o}),e.collect.emit(A.TokenError),e.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Fetch WebID Request Data Error, Use LocalId",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")),e.complete({web_id:e.configManager.get("web_id")||i,user_unique_id:e.configManager.get("user_unique_id")||i})},fail:function(){e.complete({web_id:e.configManager.get("web_id")||o,user_unique_id:e.configManager.get("user_unique_id")||o}),e.collect.configManager.set({localWebId:o}),e.collect.emit(A.TokenError),e.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Fetch WebID Request Network Fail, Use LocalId",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},e.prototype.complete=function(e){var t=e.web_id,i=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:i}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK UserInfo Complete",logType:"info",secType:"USER",level:"info",time:Date.now(),data:{web_id:t,user_unique_id:i},infoType:"sdk"}),this.collect.emit(A.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",i=this.configManager.get("user_unique_id");(i||t)&&this.configManager.set({user_unique_id:i||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(A.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),i=this.configManager.get("user_unique_id"),o=this.cacheToken&&this.cacheToken.user_unique_id;if(t===i&&t===o)return;this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(A.TokenChange,"uuid"),this.collect.emit(A.SessionReset)}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(A.TokenReset))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),i=this.configManager.get("user_unique_id");i&&i!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(A.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(A.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this;return new Promise((function(t){if("tcpy"!==e.config.channel_type&&"ttp"!==e.config.channel_type){var i={app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")};e.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Fetch GetToken Request",logType:"fetch",level:"info",time:Date.now(),data:i,infoType:"sdk"}),e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:i,success:function(i){i&&0===i.e?(t(i.tobid),e.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Fetch GetToken Request Success",logType:"fetch",level:"info",time:Date.now(),data:i,infoType:"sdk"})):(t(""),e.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Fetch GetToken Request Fail",logType:"fetch",level:"error",time:Date.now(),data:i,infoType:"sdk"}))},fail:function(){t(""),e.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Fetch GetToken Request Network Error",logType:"fetch",level:"error",time:Date.now(),infoType:"sdk"})},time:3e4,withCredentials:e.enable_ttwebid})}else t("")}))},e}(),P=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},V=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;this.collect=e,this.storage=new y(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSessionTimeCheck=t.disable_session_check,this.disableSession||(this.setSessionId(),this.collect.on(A.SessionReset,(function(e){i.resetSessionId(e)})),this.collect.on(A.SessionResetTime,(function(){i.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:P(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:P(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.disableSessionTimeCheck||(this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(e){var t={sessionId:e||P(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&(Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:P(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e)))},e}(),K=function(){function e(e,t){this.collector=e,this.config=t,this.requestType=t.request_type,this.supportBeacon=!(!window.navigator||!window.navigator.sendBeacon),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},this.customHeader=t.custom_request_header||{}}return e.prototype.useFetch=function(e){var t=e.url,i=e.data,o=e.method,n=e.success,r=e.fail,s={"Content-Type":"application/json; charset=utf-8"};if(Object.keys(this.customHeader).length)for(var a in this.customHeader)s[a]=this.customHeader[a];window.fetch?fetch(t,{method:o||"POST",headers:s,body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){n&&n(e)})).catch((function(e){r&&r(i,e)})):(this.requestType="xhr",console.log("your brwoser not support fetch, use xhr"),this.useRequest({url:t,data:i,method:o,success:n,fail:r}))},e.prototype.useBeacon=function(e){var t=e.url,i=e.data,o=e.success,n=e.fail;"xhr"!==this.requestType?window.navigator.sendBeacon(t,JSON.stringify(i))?o&&o():n&&n(i,this.errorCode.BEACON_FALSE):this.useXhr(e)},e.prototype.useXhr=function(e){var t=this,i=e.url,o=e.data,n=e.method,r=e.success,s=e.fail,a=e.timeout,c=e.withCredentials,l=e.app_key;try{var h=new XMLHttpRequest,u=n||"POST";if(h.open(u,""+i,!0),h.setRequestHeader("Content-Type","application/json; charset=utf-8"),l&&h.setRequestHeader("X-MCS-AppKey",""+l),Object.keys(this.customHeader).length)for(var p in this.customHeader)h.setRequestHeader(p,this.customHeader[p]);c&&(h.withCredentials=!0),a&&(h.timeout=a,h.ontimeout=function(){s&&s(o,t.errorCode.TIMEOUT)}),h.onload=function(){if(r){var e=null;if(h.responseText){try{e=JSON.parse(h.responseText)}catch(t){e={}}r(e,o)}}},h.onerror=function(){h.abort(),s&&s(o,t.errorCode.XHR_ON)},h.send(JSON.stringify(o))}catch(e){}},e.prototype.useRequest=function(e){var t=e.useBeacon,i=e.forceXhr;if("xhr"===this.requestType)this.useXhr(e);else{if(t&&this.supportBeacon)return void this.useBeacon(e);if("fetch"===this.requestType&&!i)return void this.useFetch(e);this.useXhr(e)}},e}(),q=function(){function e(e,t){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,t.enable_debug&&"Microsoft Internet Explorer"!==e.configManager.get("browser")){this.collect=e,this.config=t,this.app_id=t.app_id;var i=e.adapters.storage;this.cacheStorgae=new i(!1),this.loadUrl=t.devtool_url||"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/devtool/debug-web.v2.0.0.js",this.filterEvent=new Set(["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"]),this.load()}}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){console.log("load DevTool render fail")},t.onload=function(){console.log("load DevTool render success")},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){console.log("devTool load fail, "+e.message)}},e.prototype.parseUrl=function(){var e={};try{var t=window.location.href.split("?")[1].split("&");t.length&&t.forEach((function(t){var i=t.split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}))}catch(e){}return e},e.prototype.load=function(){try{var e=this.parseUrl();if(e.open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return}else if(!this.getStorage())return;this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool()}catch(e){console.log("debug fail, "+e.message)}},e.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_open_devtool_web");return e&&parseInt(e)===this.app_id},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_open_devtool_web",this.app_id)},e.prototype.loadDevTool=function(){this.loadScript(this.loadUrl)},e.prototype.loadBaseInfo=function(){if(this.log=[],this.event=[],this.info=[{title:"BaseInfo",key:"base",type:1,content:[{name:"app_id",desc:"APPID",value:this.config.app_id},{name:"channel",desc:"CHANNEL",value:this.config.channel},{name:"domain",desc:"Domain",value:this.collect.configManager.getDomain()},{name:"sdk_version",desc:"SDK Version",value:"5.3.1_oversea"},{name:"sdk_type",desc:"SDK Import Type",value:"script"}]},{title:"UserInfo",key:"user",type:2,content:[{name:"uuid",desc:"UserUniqueId",value:this.collect.configManager.get("user").user_unique_id||""},{name:"web_id",desc:"WEB_ID",value:this.collect.configManager.get("user").web_id||""}]},{title:"CommonInfo",type:2,key:"common",content:[{name:"browser",desc:"Browser",value:this.collect.configManager.get("browser")},{name:"browser_version",desc:"Browser Version",value:this.collect.configManager.get("browser_version")},{name:"platform",desc:"Platform",value:this.collect.configManager.get("platform")},{name:"device_model",desc:"Devide Model",value:this.collect.configManager.get("device_model")},{name:"os_name",desc:"Os Name",value:this.collect.configManager.get("os_name")},{name:"os_version",desc:"Os Version",value:this.collect.configManager.get("os_version")},{name:"resolution",desc:"Screen Resolution",value:this.collect.configManager.get("resolution")},{name:"referrer",desc:"Referrer",value:this.collect.configManager.get("referrer")},{name:"custom",desc:"Custom Info",value:JSON.stringify(this.collect.configManager.get("custom"))}]},{title:"Config Info",key:"config",type:3,content:[{name:"autotrack",desc:"AutoTrackEvent",value:!!this.config.autotrack},{name:"stay",desc:"StayDuration",value:!!this.config.enable_stay_duration}]},{title:"A/B Config Info",key:"ab",type:4,content:[{name:"ab",desc:"A/BTester",value:!!this.config.enable_ab_test}]}],this.config.enable_ab_test){var e=this.getInfo("ab"),t=[{name:"ab",desc:"A/BTester",value:!!this.config.enable_ab_test},{name:"vid",desc:"A/B VID",value:this.collect.configManager.getAbVersion()},{name:"ab_domain",desc:"Domain",value:this.config.ab_channel_domain||c(S[this.config.channel])},{name:"all_values",desc:"A/B ALL Values",value:this.collect.configManager.getAbCache()}];e.content=t,this.setInfo("ab",e)}},e.prototype.getInfo=function(e){var t=null;return this.info.forEach((function(i){i.key===e&&(t=i)})),t},e.prototype.setInfo=function(e,t){var i=!1;this.info.forEach((function(o){o.key===e&&(i=!0,o=t)})),i||this.info.push(t)},e.prototype.getSecondInfo=function(e,t){var i=this.getInfo(e),o=null;return i.content.forEach((function(e){e.name===t&&(o=e)})),o},e.prototype.setSecondInfo=function(e,t,i){var o=this.getInfo(e);o.content.forEach((function(e){e.name===t&&(e.value=i)})),this.setInfo(e,o)},e.prototype.loadHook=function(){var e=this;this.collect.on(k.DEBUGGER_MESSAGE,(function(t){switch(t.type){case k.DEBUGGER_MESSAGE_SDK:var i={time:t.time,type:t.logType||"sdk",infoType:t.infoType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(i.desc={content:JSON.stringify(t.data)}),e.updateLog(i),t.secType&&"AB"===t.secType?(e.setSecondInfo("ab","vid",e.collect.configManager.getAbVersion()),e.setSecondInfo("ab","all_values",e.collect.configManager.getAbCache())):"USER"===t.secType&&(e.setSecondInfo("user","uuid",e.collect.configManager.get("user").user_unique_id),e.setSecondInfo("user","web_id",e.collect.configManager.get("user").web_id)),void e.updateInfo();case k.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var o=t.data[0],n=o.events;if(!n.length)return;n.forEach((function(i){i.checkShow=!0,i.searchShow=!0,i.focusShow=!0,i.status=t.status,i.type=e.filterEvent.has(i.event)?"sdk":"cus",i.verifyType=t.verifyType?"verify":"no",i.info="","fail"===t.status&&(i.info={message:"code: "+t.code+"ï¼Œ msg: "+(t.msg||t.failType)})})),e.updateEvent(o)}return}}))},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event,sdk_type:"5.3.1_oversea".includes("tob")?"tob":"inner",appId:e.app_id}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.setSecondInfo("user","sid",t.tobid),e.updateInfo()}))}))},e.prototype.sendData=function(e,t){try{var i={type:e,payload:t};window&&window.postMessage(i,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e="#debugger-applog-web {\n      position: fixed;\n      width: 45px;\n      height: 45px;\n      background-image: url("+c("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1bz1cz24z22z1mz1mz1jz4bz18z1nz1nz1jz1mz1ez4az1nz1lz1e")+");\n      bottom: 5%;\n      right: 10%;\n      cursor: pointer;\n      z-index:100;\n      background-size: 45px;\n    }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.appendChild(document.createTextNode(e)),t.appendChild(i);var o=document.createElement("div");o.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web"></div>';var n=document.createElement("div");n.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(o),document.getElementsByTagName("body")[0].appendChild(n);var r=document.getElementById("debugger-applog-web");r&&r.addEventListener("click",(function(){window&&window.postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),j={autotrack:{src:{sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/autotrack.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/ab.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/ab.js"},object:"LogAb"},stay:{src:{sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/stay.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/stay.js"},object:"LogStay"},route:{src:{sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/route.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/route.js"},object:"LogRoute"},tracer:{src:{sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/tracer.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/tracer.js"},object:"LogTracer"},retry:{src:{sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/retry.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/retry.js"},object:"LogRetry"},visual:{src:{sg:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-sg/log-sdk/collect/5/plugin/visual.js",va:"https://lf-global-static.iapplogcdn.com/obj/applog-sdk-static-us/log-sdk/collect/5/plugin/visual.js"},object:"LogVisual"}},H=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"],J=function(){function t(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=e,this.hook=new n,this.remotePlugin=new Map,this.Types=A,this.adapters.storage=y,this.loadType="full"}return t.usePlugin=function(e,i,o){if(i){for(var n=!1,r=0,s=t.plugins.length;r<s;r++){if(t.plugins[r].name===i){t.plugins[r].plugin=e,t.plugins[r].options=o||{},n=!0;break}}n||t.plugins.push({name:i,plugin:e,options:o})}else t.plugins.push({plugin:e})},t.prototype.usePlugin=function(e,t,i){e&&("full"===this.loadType&&H.includes(e)?console.info("your sdk version has "+e+" already ~"):t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:i}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk"))},t.prototype.init=function(e){var i,o,n=this;try{i=JSON.parse(JSON.stringify(e))}catch(t){i=e}if(this.logger=new I(this.name,i.log),this.inited)this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!");else if(i&&r(i))if(i.app_id&&("number"==typeof(o=i.app_id)&&!isNaN(o)))if(!i.app_key||function(e){return"string"==typeof e}(i.app_key)){var s=["sg","va","in","ie","ie2"];i.channel_domain||-1!==s.indexOf(i.channel)||(this.logger.warn("your channel: "+i.channel+" is not exist. channel must be one of "+s.join(",")+", use sg instead, please check!!!"),i.channel="sg"),this.spider=new O,this.spider.checkSpider(i)?this.logger.warn("The current environment may be a spider, can not report!"):(this.appBridge=new B(this,i.enable_native),this.requestManager=new K(this,i),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new x(this,i),this.debugger=new q(this,i),this.initConfig=i,this.emit(A.Init),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute Init",data:i,level:"info",time:Date.now(),infoType:"cus"}),i.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.setAppid(i.app_id),this.eventManager=new U,this.tokenManager=new N,this.sessionManager=new V,Promise.all([new Promise((function(e){n.once(A.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){n.once(A.Start,(function(){e(!0)}))}))]).then((function(){try{t.plugins.reduce((function(e,t){var i=t.plugin,o=t.options,r=Object.assign(n.initConfig,o);n.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Load "+t.name+" Plugin",level:"info",time:Date.now(),infoType:"sdk"});var s=new i;return s.apply(n,r),e.push(s),e}),n.pluginInstances)}catch(e){console.warn("load plugin error, "+e.message),n.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Load Plugin Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}n.sdkReady=!0,n.emit(A.Ready),n.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Initialization Completed",time:Date.now(),level:"info",secType:"USER",data:n.configManager.get("user"),infoType:"sdk"}),n.logger.info("appid: "+i.app_id+", userInfo:"+JSON.stringify(n.configManager.get("user"))),n.logger.info("appid: "+i.app_id+", sdk is ready, version is 5.3.1_oversea, you can report now !!!"),i.disable_auto_pv&&(n.disableAutoPageView=!0);try{("full"===n.loadType&&i.enable_ab_test||i.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){n.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}n.pageView(),n.on(A.TokenChange,(function(e){"webid"===e&&n.pageView(),n.logger.info("appid: "+i.app_id+" token change, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Set UserInfo",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user"),infoType:"sdk"})})),n.on(A.TokenReset,(function(){n.logger.info("appid: "+i.app_id+" token reset, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Reset UserInfo",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user"),infoType:"sdk"})})),n.on(A.RouteChange,(function(e){e.init||i.disable_route_report||n.pageView()}))})),this.tokenManager.apply(this,i),this.eventManager.apply(this,i),this.sessionManager.apply(this,i)),this.inited=!0)}else this.logger.warn("app_key param is error, must be string, please check!");else this.logger.warn("app_id param is error, must be number, please check!");else this.logger.warn("init params error,please check")},t.prototype.config=function(t){if(this.inited)if(t&&r(t)){var i;try{i=JSON.parse(JSON.stringify(i))}catch(e){i=t}if(this.bridgeReport)this.appBridge.setConfig(i);else{i._staging_flag&&1===i._staging_flag&&(this.staging=!0),i.disable_auto_pv&&(this.disableAutoPageView=!0,delete i.disable_auto_pv);var o=e({},i);if(this.initConfig&&this.initConfig.configPersist){var n=this.configManager.getStore();n&&(o=Object.assign(n,i)),this.configManager.setStore(i)}o.web_id,o.user_unique_id;var s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&(i[o[n]]=e[o[n]])}return i}(o,["web_id","user_unique_id"]);o.hasOwnProperty("web_id")&&this.emit(A.ConfigWebId,o.web_id),o.hasOwnProperty("user_unique_id")&&this.emit(A.ConfigUuid,o.user_unique_id),this.configManager.set(s),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute Config",level:"info",time:Date.now(),data:o,infoType:"cus"})}}else console.warn("config params is error, please check");else console.warn("config must be use after function init")},t.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(A.ConfigDomain)},t.prototype.getConfig=function(e){return this.configManager.get(e)},t.prototype.send=function(){this.start()},t.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(A.Start),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute Start",level:"info",time:Date.now(),infoType:"cus"}),this.bridgeReport&&(this.pageView(),this.emit(A.Ready)))},t.prototype.event=function(e,t){var i=this;try{var o=[];if(Array.isArray(e))e.forEach((function(e){var t=i.processEvent(e[0],e[1]||{});t&&o.push(t)}));else{var n=this.processEvent(e,t);if(!n)return;o.push(n)}this.bridgeReport?o.forEach((function(e){var t=e.event,o=e.params;i.appBridge.onEventV3(t,JSON.stringify(o))})):o.length&&(this.emit(A.Event,o),this.emit(A.SessionResetTime)),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute Event",level:"info",time:Date.now(),data:e,infoType:"cus"})}catch(e){this.logger.warn("something error, please check"),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute Event Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},t.prototype.beconEvent=function(e,t){if(Array.isArray(e))this.logger.warn("beconEvent not support batch report, please check");else{var i=[],o=this.processEvent(e,t||{});o&&(i.push(o),i.length&&(this.emit(A.BeconEvent,i),this.emit(A.SessionResetTime)),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute Beacon Event",level:"info",time:Date.now(),data:e,infoType:"sdk"}))}},t.prototype.beaconEvent=function(e,t){this.beconEvent(e,t)},t.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return console.warn("eventName is nullï¼Œ please check"),null;var i=e;/^event\./.test(e)&&(i=e.slice(6));var o=t;"object"!=typeof o&&(o={}),o.profile?delete o.profile:o.event_index=a();var n=void 0;return o.local_ms?(n=o.local_ms,delete o.local_ms):n=+new Date,{event:i,params:o,local_time_ms:n,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(i){return this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Something Error",level:"error",time:Date.now(),data:i.message,infoType:"sdk"}),{event:e,params:t}}},t.prototype.filterEvent=function(e){this.eventFilter=e},t.prototype.on=function(e,t){this.hook.on(e,t)},t.prototype.once=function(e,t){this.hook.once(e,t)},t.prototype.off=function(e,t){this.hook.off(e,t)},t.prototype.emit=function(e,t,i){this.hook.emit(e,t,i)},t.prototype.set=function(e){this.hook.set(e)},t.prototype.stop=function(){this.sdkStop=!0},t.prototype.reStart=function(){this.sdkStop=!1},t.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},t.prototype.predefinePageView=function(t){if(void 0===t&&(t={}),this.inited){var i={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},o=e(e({},i),t);this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Report PV",level:"info",time:Date.now(),infoType:"sdk"}),this.event("predefine_pageview",o)}else console.warn("predefinePageView should call after init")},t.prototype.clearEventCache=function(){this.emit(A.CleanEvents)},t.prototype.setWebId=function(e){this.config({web_id:""+e})},t.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},t.prototype.getSessionId=function(){return P()},t.prototype.setSessionId=function(e){this.emit(A.SessionReset,e)},t.prototype.resetStayDuration=function(e,t,i){this.emit(A.ResetStay,{url_path:e,title:t,url:i},A.Stay)},t.prototype.resetStayParams=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),this.emit(A.SetStay,{url_path:e,title:t,url:i},A.Stay)},t.prototype.getToken=function(t,i){var o=this;if(this.inited){var n=!1,r=function(i){if(!n){n=!0;var r=o.configManager.get().user;return i&&(r.tobid=i,r["diss".split("").reverse().join("")]=i),t(e({},r))}},s=function(){o.tokenManager.getTobId().then((function(e){r(e)}))};this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute GetToken",level:"info",time:Date.now(),infoType:"cus"}),this.sdkReady?s():(i&&setTimeout((function(){r()}),i),this.on(A.Ready,(function(){s()})))}else console.warn("predefinePageView should call after init")},t.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(A.ProfileSet,e,A.Profile),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute profileSet",level:"info",time:Date.now(),data:e})},t.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(A.ProfileSetOnce,e,A.Profile),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute profileSetOnce",level:"info",time:Date.now(),data:e})},t.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(A.ProfileIncrement,e,A.Profile),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute profileIncrement",level:"info",time:Date.now(),data:e})},t.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(A.ProfileUnset,e,A.Profile),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute profileUnset",level:"info",time:Date.now(),data:e})},t.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(A.ProfileAppend,e,A.Profile),this.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute profileAppend",level:"info",time:Date.now(),data:e})},t.prototype.setExternalAbVersion=function(e){this.emit(A.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,A.Ab)},t.prototype.getVar=function(e,t,i,o){this.emit(A.AbVar,{name:e,defaultValue:t,callback:i,uuid:o},A.Ab)},t.prototype.getABconfig=function(e,t){this.emit(A.AbConfig,{params:e,callback:t},A.Ab)},t.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},t.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(A.AbVersionChangeOn,e,A.Ab),function(){t.emit(A.AbVersionChangeOff,e,A.Ab)}},t.prototype.offAbSdkVersionChange=function(e){this.emit(A.AbVersionChangeOff,e,A.Ab)},t.prototype.openOverlayer=function(){this.emit(A.AbOpenLayer,"",A.Ab)},t.prototype.closeOverlayer=function(){this.emit(A.AbCloseLayer,"",A.Ab)},t.prototype.getAllVars=function(e){this.emit(A.AbAllVars,e,A.Ab)},t.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(A.TokenComplete),this.emit(A.DestoryInstance))},t.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(A.TokenComplete),this.emit(A.DestoryInstance))},t.plugins=[],t}(),W=function(){return"undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null},F="__rangers_ab_style__";!function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(z||(z={}));var X=function(){function t(){this.fetchStatus="no",this.refreshFetchStatus="no",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data={},this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return t.prototype.apply=function(e,t){var i=this;if(this.collect=e,this.config=t,this.config.enable_ab_test){var o=t.enable_multilink,n=t.ab_channel_domain,r=t.enable_ab_visual,s=t.ab_cross,a=t.ab_cookie_domain,l=t.ab_timeout,h=t.disable_auto_ab,u=S[t.channel||"sg"]||S.sg,p=n||c(u),d=e.adapters.storage;this.cacheStorgae=new d(!1),this.timeout=l||3e3,this.enable_multilink=o,this.enable_ab_visual=r,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.ab_cross=s,this.ab_cookie_domain=a||"",this.fetchUrl=p+"/service/2/abtest_config/",this.reportUrl=this.collect.configManager.getUrl("event"),this.exposureLimit=t.exposure_limit||20,this.ab_batch_time=t.ab_batch_time||500,this.ab_user_mode=t.ab_user_mode||"user_unique_id";var f=this.collect.Types;this.types=f,this.collect.on(f.TokenChange,(function(e){"uuid"===e&&i.readyStatus&&(i.clearCache(),i.fetchAB())})),this.collect.on(f.AbVar,(function(e){var t=e.name,o=e.defaultValue,n=e.callback;i.getVar(t,o,n)})),this.collect.on(f.AbAllVars,(function(e){i.getAllVars(e)})),this.collect.on(f.AbConfig,(function(e){var t=e.params,o=e.callback;i.getABconfig(t,o)})),this.collect.on(f.AbExternalVersion,(function(e){i.setExternalAbVersion(e)})),this.collect.on(f.AbOpenLayer,(function(){i.openOverlayer()})),this.collect.on(f.AbCloseLayer,(function(){i.closeOverlayer()})),this.collect.on(f.AbVersionChangeOn,(function(e){i.changeListener.set(e,e)})),this.collect.on(f.AbVersionChangeOff,(function(e){i.changeListener.get(e)&&i.changeListener.delete(e)})),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(!h&&this.fetchAB(),this.readyStatus=!0),this.collect.emit(f.AbReady)}},t.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var o=function(e){i[e].length&&i[e].forEach((function(i){t.collect.hook.emit(e,i)}))};for(var n in i)o(n)}},t.prototype.loadMode=function(){var e=function(){try{var e=JSON.parse(atob(window.name));return e||void 0}catch(e){return}}(),t="";if(e){var i=e.scenario,o=e.href;i?(this.editMode=!0,t=i):!o||-1===o.indexOf("datatester")&&-1===o.indexOf("visual-editor")||(this.editMode=!0,t="visual-editor")}this.enable_ab_visual&&"visual-editor"===t&&this.collect.destoryInstace()},t.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,i=e.ab_ext_version,o=e.ab_version_multilink,n=(e.data,this.checkFromUrl());n?this.mulilinkVersions.push(n):this.mulilinkVersions=o||[],this.extVersions=i||[],this.versions=t||[];var r=this.versions.concat(this.extVersions);this.enable_multilink&&(r=r.concat(this.mulilinkVersions))},t.prototype.checkFromUrl=function(){var e=p(window.location.href);return e&&e.vid?e.vid:""},t.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach((function(t){"function"==typeof t&&t(e)}))},t.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},t.prototype.getVar=function(e,t,i,o){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof i)throw new Error("callback must be a function");var n={name:e,defaultValue:t,callback:i,type:z.Var};this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK Execute GetVar",level:"info",time:Date.now(),data:e,infoType:"cus"}),"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(n,e,o):this.callbacks.push(n)},t.prototype.setAbUuid=function(e,t){this.collect.configManager.setAbUuidCache(e,t)},t.prototype.getRealVar=function(e,t,i){var o=e.name,n=e.defaultValue,s=e.callback,a=this.data;if(a){if(r(a[o])){var c=a[o].vid;return"$ab_url"===t?this.mulilinkVersions.includes(c)||this.mulilinkVersions.push(c):this.versions.includes(c)||this.versions.push(c),this.setAbUuid(c,i),this.updateVersions(),this.fechEvent(c,t,n),s(a[o].val),void this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK Execute GetVar, Exposure Experiment "+o,level:"info",time:Date.now(),data:a[o],infoType:"sdk"})}this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK Execute GerVar Default Callback",level:"info",time:Date.now(),data:this.data,infoType:"sdk"}),s(n)}else s(n)},t.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:z.All};this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK Execute GetAllVars",level:"info",time:Date.now(),infoType:"cus"}),"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbacks.push(t)},t.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK Execute GetAllVars Callback",level:"info",time:Date.now(),data:this.data,infoType:"sdk"})},t.prototype.fechEvent=function(e,t,i){try{if(this.config.disable_track_event)return;if(!e)return;var o=this.collect.configManager.get(),n=o.header,r=o.user,s=this.getABCache(),a=r[this.ab_user_mode]||r.user_unique_id;if(s&&s.uuid&&s.uuid!==a)return;var c={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?i:window.location.href,data:this.data}),local_time_ms:Date.now()};n.custom=JSON.stringify(n.custom);var l={events:[c],user:r,header:n};this.reportExposure(l,t)}catch(e){this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Something Error",level:"error",time:Date.now(),data:e.message,infoType:"sdk"})}},t.prototype.reportExposure=function(e,t){var i=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(t):this.reportTimeout=setTimeout((function(){i.report(t),clearTimeout(i.reportTimeout)}),this.ab_batch_time)},t.prototype.report=function(e){var t=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:"$ab_url"===e}),this.exposureCache.forEach((function(e){t.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_EVENT,info:"SDK Report Exposure Event Success",time:Date.now(),data:[e],code:200,status:"success",infoType:"sdk"})})),this.exposureCache=[]},t.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},t.prototype.getABconfig=function(e,t){var i=Object.keys(e);i&&i.length&&this.collect.configManager.set(e),this.fetchAB(t)},t.prototype.get=function(e){return this.cacheStorgae.getItem(e)},t.prototype.set=function(e,t){this.cacheStorgae.setItem(e,t),this.collect.configManager.setAbCache(t),this.collect.event("abtest_cache",{env_uuid:this.collect.configManager.get("user").user_unique_id||"",cache:JSON.stringify(t)})},t.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.get(this.abKey)||t,e?t[e]:t},t.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},t.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.set(this.abKey,t)},t.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},t.prototype.openOverlayer=function(e){var t=this;if(function(){if(!document.getElementById(F)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=F,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}}(),e)var i=setTimeout((function(){t.closeOverlayer(),clearTimeout(i)}),e)},t.prototype.closeOverlayer=function(){var e;(e=document.getElementById(F))&&e.parentElement.removeChild(e)},t.prototype.fetchComplete=function(e,t){var i=this;try{if(e&&"[object Object]"==Object.prototype.toString.call(e)){this.data=e,this.setAbCache(t);var o=[];Object.keys(e).forEach((function(t){var i=e[t].vid;i&&o.push(i)})),this.versions=this.versions.filter((function(e){return o.includes(e)}));var n=e.$ab_url,r=e.$ab_modification;if(r&&r.val&&this.enable_ab_visual){if(this.collect.destroy)return}else if(n&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter((function(e){return o.includes(e)}));var s=n.val,a=n.vid;s&&a&&this.getVar("$ab_url",s,(function(){i.editMode||(s!==window.location.href?setTimeout((function(){if(!i.collect.destroy){var e=""+s;e=-1===e.indexOf("http")?"https://"+e:e,u(e).host!==location.host?e=e+"&vid="+a:window.history.replaceState("","",e),window.location.href=e}}),100):i.closeOverlayer())}))}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach((function(e){return i[e.type===z.Var?"getRealVar":"getRealAllVars"](e,"")})),this.callbacks=[]}catch(e){}},t.prototype.fetchAB=function(t){var i=this,o=this.collect.configManager.get(),n={header:e(e(e({aid:this.config.app_id},o.user||{}),o.header||{}),{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Fetch AB Request",level:"info",logType:"fetch",time:Date.now(),data:n,infoType:"sdk"});var r=o.user[this.ab_user_mode]||o.user.user_unique_id;this.collect.requestManager.useRequest({url:this.fetchUrl,data:n,success:function(e){i.fetchStatus="complete",i.refreshFetchStatus="complete";var o=e.data;"success"===e.message?(i.fetchComplete(o,r),t&&t(o)):(i.fetchComplete(null,r),t&&t(null)),i.collect.emit(i.types.AbComplete,o),i.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK Fetch AB Request Success",level:"info",logType:"fetch",time:Date.now(),data:o,infoType:"sdk"})},fail:function(){i.fetchStatus="complete",i.refreshFetchStatus="complete",i.fetchComplete(null,r),i.collect.emit(i.types.AbTimeout),t&&t(null),i.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK Fetch AB Request Network Error",level:"error",logType:"fetch",time:Date.now(),infoType:"sdk"})},timeout:this.timeout})},t.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true[\0-Ã¿]*":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true[\0-Ã¿]*");var i=new RegExp(t,"g");e=e.replace(i,"")}catch(e){}return e},t}();try{var $=W();$&&($.LogAb=function(e,t){(new X).apply(e,t)})}catch(e){console.log(e)}var Y=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(t.event_verify_url)if("string"==typeof t.event_verify_url){if(this.url=t.event_verify_url+"/v1/list_test",this.url){var o=e.Types;e.on(o.SubmitBefore,(function(t){e.requestManager.useBeacon({url:i.url,data:t}),e.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_EVENT,info:"SDK Report ByteIo Verify Request",time:Date.now(),data:t,code:200,status:"success",verifyType:!0})}))}}else console.log("please use correct et_test url")},e}(),Z=function(){function t(e,t){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.focusState=!0,this.collect=e,this.config=t,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,r(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus()}return t.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},t.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageAlive(),this.hard&&(this.removeMode=this.hardMode())},t.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},t.prototype.sendEvent=function(t,i){void 0===i&&(i=!1);var o=i?this.aliveDTime:Date.now()-this.sessionStartTime;o<0||o>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||i&&"hidden"===document.visibilityState||this.hard&&!this.focusState||(this.collect.beconEvent(this.options.aliveName,e({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:o,is_support_visibility_change:h(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:t,mode:this.hard?"hard":"normal",focusState:this.focusState},this.options.params)),this.sessionStartTime=Date.now())},t.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},t.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval((function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!1,!0)}),1e3)},t.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},t.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},t.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),l(i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("beforeunload",i),window.removeEventListener("pagehide",i)}},t.prototype.hardMode=function(){var e=this,t=function(){e.timerHandler&&(clearInterval(e.timerHandler),e.sendEvent(!1)),e.focusState=!1},i=function(){e.focusState=!0,e.sessionStartTime=Date.now(),e.timerHandler=e.setUpTimer()};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},t}(),Q=function(){function t(e,t){var i=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.focusState=!0,this.visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=Date.now():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=Date.now())},this.beforeunload=function(){if(i.totalTime+=(i.activeEndTime||Date.now())-i.activeStartTime,i.config.autotrack){try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(e){}}i.sendEventPageClose()},this.collect=e,this.config=t,this.maxDuration=t.maxDuration||864e5,this.pageStartTime=Date.now(),r(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.hard=this.options.mode&&"hard"===this.options.mode,this.focusState=document.hasFocus(),this.resetData()}return t.prototype.setParams=function(e,t,i){this.set_path=e,this.set_url=i,this.set_title=t},t.prototype.resetParams=function(e,t,i){this.url_path=e,this.url=i,this.title=t},t.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this.enablePageClose(),this.hard&&(this.removeMode=this.hardMode())},t.prototype.disable=function(){this.disableCallback()},t.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},t.prototype.sendEventPageClose=function(){var t=Date.now()-this.pageStartTime;this.totalTime<0||t<0||this.totalTime>=this.maxDuration||this.hard&&!this.focusState||(this.collect.beconEvent(this.options.closeName,e({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:t,is_support_visibility_change:h(),mode:this.hard?"hard":"normal",focusState:this.focusState},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},t.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},t.prototype.enablePageClose=function(){var e=this,t=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),l(i),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("beforeunload",i),window.removeEventListener("pagehide",i)}},t.prototype.hardMode=function(){var e=this,t=function(){e.focusState=!1},i=function(){e.focusState=!0};return window.addEventListener("blur",t),window.addEventListener("focus",i),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",i)}},t}(),ee=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,this.config=t,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new Z(e,t),this.pageClose=new Q(e,t);var o=this.collect.Types;this.collect.on(o.ResetStay,(function(e){var t=e.url_path,o=e.title,n=e.url;i.resetStayDuration(t,o,n)})),this.collect.on(o.RouteChange,(function(e){e.init||t.disable_route_report||i.resetStayDuration()})),this.collect.on(o.SetStay,(function(e){var t=e.url_path,o=e.title,n=e.url;i.setStayParmas(t,o,n)})),this.enable(this.url_path,this.title,this.url),this.ready(o.Stay),this.collect.emit(o.StayReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var i=this.collect.hook._hooksCache[e];if(!Object.keys(i).length)return;var o=function(e){i[e].length&&i[e].forEach((function(i){t.collect.hook.emit(e,i)}))};for(var n in i)o(n)}},e.prototype.enable=function(e,t,i){this.pageAlive.enable(e,t,i),this.pageClose.enable(e,t,i)},e.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.setStayParmas=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),this.pageAlive.setParams(e,t,i),this.pageClose.setParams(e,t,i),this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute resetStayParams",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e.prototype.reset=function(e,t,i){this.disable(),this.enable(e,t,i)},e.prototype.resetStayDuration=function(e,t,i){this.reset(e,t,i),this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"SDK Execute resetStayDuration",level:"info",time:Date.now(),data:{url_path:e,title:t,url:i}})},e}();try{var te=W();te&&(te.LogStay=function(e,t){(new ee).apply(e,t)})}catch(e){console.log(e)}var ie=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var i,o=Date.now()+t;return i=window.setTimeout((function n(){var r=Date.now()-o;e(),o+=t,i=window.setTimeout(n,Math.max(0,t-r))}),t),function(){window.clearTimeout(i)}}((function(){e.isSessionhasEvent&&e.endCurrentSession()}),e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,!t.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var o=this.collect.Types;this.collect.on(o.SessionReset,(function(){i.process()}))}},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),oe=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(this.collect=e,this.config=t,!this.config.channel_domain&&!t.disable_track_event&&!t.disable_sdk_monitor){this.url=e.configManager.getUrl("event");var o=this.collect.Types;this.collect.on(o.Ready,(function(){i.sdkOnload()})),this.collect.on(o.SubmitError,(function(e){var t=e.type,o=e.eventData,n=e.errorCode;"f_data"===t&&i.sdkError(o,n)}))}},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),i=t.header,o=t.user,n=i.app_id,r=i.app_name,s=i.sdk_version,a=o.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:n,app_name:r||"",sdk_version:s,sdk_type:"script",sdk_config:this.config,sdk_desc:"TOC_OVERSEA"}),local_time_ms:Date.now()}],user:{user_unique_id:a},header:{}};setTimeout((function(){e.collect.requestManager.useRequest({url:e.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})}),16)}catch(e){}},e.prototype.sdkError=function(e,t){var i=this;try{var o=e[0],n=o.user,r=o.header,s=[];e.forEach((function(e){e.events.forEach((function(e){s.push(e)}))}));var a={events:s.map((function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:r.app_id,app_name:r.app_name||"",error_event:e.event,sdk_version:r.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(r),user:JSON.stringify(n)}),local_time_ms:Date.now()}})),user:{user_unique_id:n.user_unique_id},header:{}};setTimeout((function(){i.collect.requestManager.useRequest({url:i.url,data:[a],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})}),16)}catch(e){}},e}();function ne(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0}return!1}function re(e){for(var t=e;t&&!ne(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function se(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}var ae=function(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0},ce=function(e,t){if("string"==typeof t)return ae(e,t);if(s(t)){for(var i=!1,o=0;o<t.length;o++){if(ae(e,t[o])){i=!0;break}}return i}};var le=function(){function t(t,i,o){var n=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(e){(function(e,t){if(1!==e.nodeType)return!1;if(!t.svg&&function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i}(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var i=e;return"none"!==i.style.display&&(!!ne(i,"container")||!(!function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some((function(e){return e.children.length>0}))}return!0}(i)&&!t.svg))})(e.target,n.options)&&n.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){n.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){n.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(t,i){i&&"pushState"===i&&n.eventHandel({eventType:"dom",eventName:"beat"},e({beat_type:0},t)),n.eventHandel({eventType:"dom",eventName:"page_view"},t)},this.getPageLoadEvent=function(e){n.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=o.getConfig().eventConfig,this.collect=i,this.options=t,this.beatTime=t.beat}return t.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},t.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e){if(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv){this.collect.on("route-change",(function(e){var i=e.config,o=e.name;t.getPageViewEvent(i,o),t.pageView=!0}));var i=setTimeout((function(){t.pageView||(t.getPageViewEvent(t.getDefaultConfig()),t.pageView=!0,clearTimeout(i))}),2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",(function(){t.beatEvent(t.beatTime)}));var o=0,n=null;window.addEventListener("scroll",(function(){clearTimeout(n),n=setTimeout(r,500),o=document.documentElement.scrollTop||document.body.scrollTop}));var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==o&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var s=window.performance&&window.performance.getEntriesByType("paint");if(s&&s.length)new PerformanceObserver((function(e){var i=e.getEntries(),o=i[i.length-1],n=o.renderTime||o.loadTime;t.statistics||(t.getPageLoadEvent(n),t.statistics=!0)})).observe({entryTypes:["largest-contentful-paint"]}),setTimeout((function(){t.statistics||(t.getPageLoadEvent(s[0].startTime||0),t.statistics=!0)}),2e3);else this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}}},t.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},t.prototype.beatEvent=function(e){var t=this;try{var i;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(i=setInterval((function(){t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})}),e)),l((function(){t.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),t.beatTime&&clearInterval(i)}))}catch(e){}},t.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},t}(),he={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},ue=function(){function e(e,t){this.config=e,this.config.eventConfig=Object.assign(this.config.eventConfig,t)}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function pe(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],o=[];return t.forEach((function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var o=i.children,n=0;n<o.length&&o[n]!==e;n++)o[n].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),ne(e,"list")?"[]":""].join(""),index:t}}(e),n=t.str,r=t.index;i.unshift(n),o.unshift(r)})),{element_path:"/"+i.join("/"),positions:o}}function de(e,t,i,o){var n={},r=function(e){if(e){var t=e.getBoundingClientRect(),i=t.width,o=t.height;return{left:t.left,top:t.top,element_width:i,element_height:o}}}(t),a=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,o=e.clientY,n=t.left,r=t.top,s=i-n>=0?i-n:0,a=o-r>=0?o-r:0;return{touch_x:Math.floor(s),touch_y:Math.floor(a)}}(e,r),c=r.element_width,l=r.element_height,h=a.touch_x,u=a.touch_y,p=pe(t),d=p.element_path,f=p.positions,g=function(e){var t=re(e),i=[];return function e(t){var o=se(t);if(o&&-1===i.indexOf(o)&&i.push(o),t.childNodes.length>0)for(var n=t.childNodes,r=0;r<n.length;r++)8!==n[r].nodeType&&e(n[r])}(t),i}(t),m=window.performance.timing.navigationStart,_=Date.now()-m,v=f.map((function(e){return""+e})),y=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(y=window.TEAVisualEditor.getOriginXpath({xpath:d,positions:v})),n.element_path=y&&y.xpath||d,n.positions=y&&y.positions||v,o&&!o.text&&(n.texts=g,n.element_title=function(e){var t=re(e),i="";return function e(t){var o=se(t);if(o&&(i+=o),t.childNodes.length>0)for(var n=t.childNodes,r=0;r<n.length;r++)3===n[r].nodeType&&e(n[r])}(t),i}(t)),n.element_id=t.getAttribute("id")||"",n.element_class_name=t.getAttribute("class")||"",n.element_type=t.nodeType,n.element_width=Math.floor(c),n.element_height=Math.floor(l),n.touch_x=h,n.touch_y=u,n.page_manual_key="",n.elememt_manual_key="",n.since_page_start_ms=_,n.page_start_ms=m,n.page_path=location.pathname,n.page_host=location.host,i.track_attr&&function(e,t){return!!ce(e,t)}(t,i.track_attr)){var b=function(e,t){var i={};if("string"==typeof t)ae(e,t)&&(i.attrs=e.getAttribute(t));else if(s(t))for(var o=0;o<t.length;o++){ae(e,t[o])&&(i[t[o]]=e.getAttribute(t[o]))}return i}(t,i.track_attr);for(var E in b)n[E]=b[E]}var S=re(t);return"A"===S.tagName&&(n.href=S.getAttribute("href")),"IMG"===t.tagName&&(n.src=t.getAttribute("src")),n}var fe=function(t,i,o,n,r){return e(e({event:t},de(i,o,n,r)),{is_html:1,page_key:window.location.href,page_title:document.title})},ge=function(){function t(e,t){this.ignore={text:!0},this.initConfig=e,this.options=t,this.eventName=t&&"tea"===t.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure"},t&&!0===t.text&&(this.ignore.text=!1),t&&t.exposure&&t.exposure.eventName&&(this.eventName.exposure=t.exposure.eventName)}return t.prototype.handleEvent=function(t,i){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}(t.target))return null;var o="bav2b_click";switch(i){case"click":return o=this.eventName.click,fe(o,t,t.target,this.options,this.ignore);case"exposure":return o=this.eventName.exposure,fe(o,t,t.target,this.options,this.ignore);case"change":return e(e({},fe(o="bav2b_change",t,t.target,this.options)),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(o,t.target));case"submit":return fe(o="bav2b_submit",t,t.target,this.options)}}catch(e){return console.error(e),null}},t.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var i=JSON.parse(t);e.refer_page_duration_ms=i?i.duration:""}e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("page event error "+JSON.stringify(e))}return e},t.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"",t.refer_page_manual_key="";try{var i=e.lcp,o=window.performance.timing,n=o.loadEventEnd-o.navigationStart;t.page_init_cost_ms=parseInt(i||(n>0?n:0)),t.page_start_ms=o.navigationStart}catch(e){console.log("page_statistics event error "+JSON.stringify(e))}return t},t.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("beat event error "+JSON.stringify(e))}return e},t}(),me=function(){function e(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){var i=e.eventSend,o=t.event;delete t.event,i&&"becon"===i?this.collect.beconEvent(o,t):this.collect.event(o,t)},e.prototype.get=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,i)},e.prototype.post=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,i)},e}(),_e={},ve=[];function ye(e,t,i,o){var n=e&&e.source||window.opener||window.parent,r=e&&e.origin||o||"*",s={type:t,payload:i};n.postMessage(JSON.stringify(s),r)}function be(e){if(ve.some((function(e){return"*"===e}))||ve.some((function(t){return e.origin.indexOf(t)>-1}))){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(!t)return;var i=t.type,o=t.payload;_e[i]&&_e[i].forEach((function(t){"function"==typeof t&&t(e,o)}))}}var Ee=!1;function Se(e){var t,i,o,n,r=e.event,s=e.editorUrl,a=e.autoTrackInstance;Ee||(Ee=!0,t=s,i=function(){ye(r,"editorScriptloadSuccess"),a.destroy()},o=function(){r&&ye(r,"editorScriptloadError"),Ee=!1},(n=document.createElement("script")).src=t,n.onerror=function(){o(t)},n.onload=function(){i()},document.getElementsByTagName("head")[0].appendChild(n))}function we(t,i){window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=i.app_id;var o,n,r,s,a,c=i.channel_domain,l="";if((o=["*"]).length&&o.forEach((function(e){ve.push(e)})),c){var h,u="";try{var p=window.performance.getEntriesByType("resource");if(p&&p.length&&(p.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(u=e.name)})),u&&(h=u.split("/"))&&h.length)){l="https:/";for(var d=2;d<h.length&&d!==h.length-1;d++)l=l+"/"+h[d];if(l&&l.indexOf("/5.0")){var f=l.split("/5.0");l=f[0]||l}}}catch(e){}}n="5.3.1_oversea",delete(r=e({},i)).filter,(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:r,version:n},"*"),window.addEventListener("message",be,!1);try{a=function(e){var o=e.data.app_id;o&&o!==i.app_id||Se({event:e,editorUrl:"https://sf16-website-login.neutral.ttwstatic.com/obj/tiktok_web_login_static/log-sdk/collect/heatmap-core.js?query="+Date.now(),autoTrackInstance:t})},_e[s="tea:openHeatMapCore"]=_e[s]||[],_e[s].push(a)}catch(e){console.log("openHeatMapCore error")}}var ke,De=function(){function e(e){this._instance=null,this._intersection=e,this.init()}return e.prototype.init=function(){var e=this;this._instance=new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e.attributeChangeObserve(t),"childList"===t.type&&e.modifyNodeObserve(t)}))})),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})},e.prototype.attributeChangeObserve=function(e){e.target.hasAttribute("data-exposure")?this.exposureAdd(e,"mutation"):this.exposureRemove(e)},e.prototype.modifyNodeObserve=function(e){var t=this;Array.prototype.forEach.call(e.addedNodes,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureAdd(e,"intersect"),t.mapChild(e,t.exposureAdd)})),Array.prototype.forEach.call(e.removedNodes,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureRemove(e),t.mapChild(e,t.exposureRemove)}))},e.prototype.mapChild=function(e,t){var i=this;1===e.nodeType&&e.children.length&&Array.prototype.forEach.call(e.children,(function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t(e),i.mapChild(e,t)}))},e.prototype.exposureAdd=function(e,t){this._intersection.exposureAdd(e,t)},e.prototype.exposureRemove=function(e){this._intersection.exposureRemove(e)},e._exposure_observer=null,e}(),Te=function(){function e(t,i){this.count=1,this.instance=this.buildObserver(),this.observeMap=e._observer_map,t.autotrack.exposure.ratio?this.Ratio=t.autotrack.exposure.ratio:0===t.autotrack.exposure.ratio?this.Ratio=0:this.Ratio=.5,this.EventHandle=i}return e.prototype.buildObserver=function(){var t=this;if(!e._observer_instance)return IntersectionObserver&&(e._observer_instance=new IntersectionObserver((function(e){e.forEach((function(e){t.observeMap.get(e.target._observeId)&&t.exposureEvent(e)}))}),{threshold:[.01,.25,.5,.75,1]})),e._observer_instance},e.prototype.exposureAdd=function(e,t){var i=e;"mutation"===t&&(i=e.target);var o=i._observeId;if(o||this.observeMap.has(o)){if(!1===i.visible){var n=i.getBoundingClientRect(),r=n.top,s=n.left,a=n.right,c=n.bottom;r>=0&&c<=window.innerHeight&&s>=0&&a<=window.innerWidth&&(i.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e))}}else i._observeId=this.count,i.visible=!1,this.observeMap.set(this.count,i),this.observe(i),this.count++},e.prototype.exposureRemove=function(e){this.observeMap.has(e._observeId)&&(this.observeMap.delete(e._observeId),this.unobserve(e))},e.prototype.exposureEvent=function(e){if(e.intersectionRatio>=this.Ratio&&e.isIntersecting){if("0"===e.target.style.opacity||"hidden"===e.target.style.visibility)return;if(!0===e.target.visible)return;e.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e)}else e.target.visible=!1},e.prototype.observe=function(e){this.instance.observe(e)},e.prototype.unobserve=function(e){this.instance.unobserve(e)},e._observer_instance=null,e._observer_map=new Map,e}(),ze=function(){function e(e,t){e.autotrack&&e.autotrack.exposure&&(this._intersection=new Te(e,t),this._observer=new De(this._intersection),this.initObserver())}return e.prototype.initObserver=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),(function(t){e._intersection.exposureAdd(t,"intersect")}))},e}(),Ae={hashTag:!1,impr:!1},Ge=function(){function e(){}return e.prototype.apply=function(e,t){if(this.autoTrackStart=!1,this.collect=e,this.config=t,t.autotrack){var i=e.Types;t.autotrack&&t.autotrack.collect_url&&!t.autotrack.collect_url()||(this.ready(i.Autotrack),this.collect.emit(i.AutotrackReady))}},e.prototype.ready=function(e){this.collect.set(e);var t=this.config.autotrack;t="object"==typeof t?t:{},t=Object.assign(Ae,t),this.destroyed=!1,this.options=t,this.Config=new ue(he,this.options),this.Exposure=new ze(this.config,this.handle.bind(this)),this.Listener=new le(t,this.collect,this.Config),this.EventHandle=new ge(this.config,t),this.Request=new me(this.collect),this.autoTrackStart=!0,this.init(),we(this,this.config)},e.prototype.init=function(){this.Listener.init(this.handle.bind(this)),"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var i=e.eventName;if("click"===i||"exposure"===i||"change"===i||"submit"===i){var o=this.EventHandle.handleEvent(t,i);null!==o&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},o)}else if("page_view"===i||"page_statistics"===i){var n=void 0;n="page_view"===i?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},n)}else if("beat"===i){var r=this.EventHandle.handleBeadtEvent(t),s=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:s},r)}}catch(e){console.log("handel dom event error "+JSON.stringify(e))}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}();try{var Me=W();Me&&(Me.LogAutoTrack=function(e,t){(new Ge).apply(e,t)})}catch(e){}!function(e){e.Net="net",e.FailNet="f_net",e.FailData="f_data"}(ke||(ke={}));var Re={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},Ce=function(){function e(){}return e.prototype.apply=function(e,t){var i=this;if(this.ready=t.app_id&&t.enable_tracer&&!t.disable_track_event,this.ready){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=e,this.appid=t.app_id,this.reportUrl=e.configManager.getUrl("event");var o=this.collect.Types;e.adapters.fetch;this.collect.on(o.Event,(function(e){s(e)?e.forEach((function(e){i.addCount("log")})):i.addCount("log")})),this.collect.on(o.SubmitError,(function(e){var t=e.type,o=e.eventDate,n=e.errorCode,r=e.response;i.addErrorCount(o,t,n,r)})),this.listener(),this.collect.emit(o.TracerReady)}},e.prototype.addCount=function(e,t,i){void 0===t&&(t="net"),void 0===i&&(i=1);try{this.tracerCache||(this.tracerCache=new Map);var o=void 0;if(this.tracerCache.has(e)){if((n=this.tracerCache.get(e)).has(t))o=n.get(t).params.count,o++,n.set(t,this.processTracer(o,e,t));else o=i,n.set(t,this.processTracer(i,e,t))}else{var n=new Map;o=i,n.set(t,this.processTracer(i,e,t)),this.tracerCache.set(e,n)}"net"===t&&o>=this.limit[e]&&this.report(!1)}catch(e){console.log(e)}},e.prototype.addErrorCount=function(e,t,i,o){var n=this;try{if(e&&e.length){var r=e[0].events;r&&r.length&&("f_data"===t?(o&&o.hasOwnProperty("sc")?this.addCount("log",t,r.length-o.sc):this.addCount("log",t,r.length),this.errorCode[t]=i):r.forEach((function(e){var o="log";for(var r in Re)if(-1!==Re[r].indexOf(e.event)){o=r;break}n.addCount(o,t,1),n.errorCode[t]=i})))}}catch(e){}},e.prototype.report=function(e){if(this.tracerCache){var t=[];this.tracerCache.forEach((function(e){console.log(e),e.forEach((function(e){t.push(e)}))})),t&&t.length&&this.sendTracer(t,e)}},e.prototype.sendTracer=function(e,t){try{var i=this.collect.eventManager.merge(e);this.collect.requestManager.useRequest({url:this.reportUrl,data:i,useBeacon:t}),this.tracerCache=null}catch(e){}},e.prototype.processTracer=function(e,t,i){try{var o={count:e,state:i,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:"5.3.1_oversea"};"f_net"!==i&&"f_data"!==i||(o.errorCode=this.errorCode[i]);var n=this.collect.processEvent("applog_trace",o);if(n&&n.event)return delete n.is_bav,n}catch(e){console.warn("something error")}},e.prototype.listener=function(){var e=this;document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.leavePage()})),l((function(){e.leavePage()}))},e.prototype.leavePage=function(){this.report(!0)},e}();try{var xe=W();xe&&(xe.LogTracer=function(e,t){(new Ce).apply(e,t)})}catch(e){console.log(e)}var Ie=function(){function e(){this.retryWaitTime=3e3,this.retryStatus=!1,this.retryCacheStatus=!1}return e.prototype.apply=function(e,t){var i=this;if(t.enable_storage&&!t.disable_storage&&(this.collect=e,this.config=t,!this.collect.destroy)){var o=e.Types,n=e.adapters.storage;this.storage=new n(!1),this.eventUrl=this.collect.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+t.app_id,this.storageNum=t.storage_num||50,this.retryNum=t.retry_num||3,this.retryInterval=1e3,e.on(o.SubmitError,(function(e){"f_data"!==e.type&&i.storeData(e)})),e.on(o.Ready,(function(){i.checkStorage()}))}},e.prototype.retryRightNow=function(e){var t=this;if(this.retryStatus)this.errorCache.push(e);else{var i=0;this.retryStatus=!0;var o=setInterval((function(){if(3===i)return t.storeData(t.errorCache),t.retryStatus=!1,void clearInterval(o);var n=e.eventData;t.fetchData(n,(function(){t.retryStatus=!1,clearInterval(o),t.retryCacheStatus&&t.errorCache.splice(0,1),t.errorCache.length&&(t.retryCacheStatus=!0,t.retryRightNow(t.errorCache[0]))}),(function(){i++}))}),this.retryInterval)}},e.prototype.storeData=function(e){var t=this.storage.getItem(this.eventKey),i=e.eventData;Object.keys(t).length!==this.storageNum&&(t[Date.now()]=i,this.storage.setItem(this.eventKey,t))},e.prototype.checkStorage=function(){var e=this;try{if(!window.navigator.onLine)return;var t=this.storage.getItem(this.eventKey);if(!t||!Object.keys(t).length)return;var i={events:[{event:"ontest",params:{app_id:this.config.app_id},local_time_ms:Date.now()}],user:{user_unique_id:this.collect.configManager.get("web_id")},header:{}};this.fetchData([i],(function(){var i=JSON.parse(JSON.stringify(t)),o=function(o){e.fetchData(t[o],(function(){delete i[o],e.storage.setItem(e.eventKey,i)}),(function(){}),!1)};for(var n in t)o(n)}),(function(){}),!0)}catch(e){console.warn("error check storage")}},e.prototype.fetchData=function(e,t,i,o){this.collect.requestManager.useRequest({url:this.eventUrl,data:e,timeout:3e4,success:t,fail:i,app_key:o?"566f58151b0ed37e":""})},e}();try{var Oe=W();Oe&&(Oe.LogStore=function(e,t){(new Ie).apply(e,t)})}catch(e){console.log(e)}var Be=W(),Ue=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,i){if("sdk"===t)if(j.hasOwnProperty(i)){var o=j[i].object,n=""+j[i].src[e.channel];e.exist(i,o,n)}else console.warn("your "+i+" is not existï¼Œplease check plugin name");else"object"==typeof t&&(t.src?e.exist(i,t.call,t.src):e.process(i,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"LoadExtend Fail",level:"error",time:Date.now(),data:e.message}),console.log("load extend error")}},e.prototype.exist=function(e,t,i){var o=this;Be[t]?(this.process(e,Be[t]),console.log("already has "+e+" plugin~")):this.loadPlugin(e,i,(function(){o.process(e,Be[t]),console.log(" %c %s %s %s","color: yellow; background-color: black;","â€“","load plugin:"+e+" success","-")}),(function(){console.log(" %c %s %s %s","color: red; background-color: yellow;","â€“","load plugin:"+e+" error","-")}))},e.prototype.process=function(e,t,i){try{if(i){var o=new t;o.apply&&o.apply(this.collect,this.config),console.log("excude "+e+" success")}else t&&t(this.collect,this.config)}catch(t){this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Extend Process Fail",level:"error",time:Date.now(),data:t.message}),console.log("excude "+e+" error, message:"+t.message)}},e.prototype.loadPlugin=function(e,t,i,o){var n=this;try{var r=document.createElement("script");r.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(i),r.onerror=function(){o(t)},r.onload=function(){n._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(r)}catch(e){this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"Extend LoadPlugin Fail",level:"error",time:Date.now(),data:e.message})}},e}(),Le=function(){function e(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return e.prototype.apply=function(e,t){if(t.spa||t.autotrack){var i=e.Types;this.collect=e,this.config=t,this.appid=t.app_id,this.allowHash=t.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),e.emit(i.RouteReady)}},e.prototype.setKey=function(){var e=this.collect.adapters.storage;this.storage=new e(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(o){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:o});var s=t.call.apply(t,i([history,o],n));if(e.collect.sdkStop||e.collect.destroy)return s;if(!(e.lastLocation===location.href||e.config.disable_spa_query&&e.pathEquel())){var a=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(a,"pushState"),s}};var o=history.replaceState;history.replaceState=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var s=o.call.apply(o,i([history,t],n));if(e.collect.sdkStop||e.collect.destroy)return s;if(!(e.lastLocation===location.href||e.config.disable_spa_query&&e.pathEquel())){var a=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(a),s}}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.getLocation=function(){return this.lastLocation},e.prototype.pathEquel=function(){try{return new URL(this.lastLocation).origin+new URL(this.lastLocation).pathname===new URL(location.href).origin+new URL(location.href).pathname}catch(e){return!1}},e.prototype.init=function(){var e=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:e,init:!0})},e.prototype.listener=function(){var e=this;window.addEventListener("hashchange",(function(t){if(!e.collect.sdkStop&&!e.collect.destroy&&e.lastLocation!==window.location.href&&(!e.config.disable_spa_query||!e.pathEquel())&&e.allowHash){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var i=e.getPopStateChangeEventData();e.sendPv(i)}})),window.addEventListener("popstate",(function(t){if(!e.collect.sdkStop&&!e.collect.destroy&&!(e.lastLocation===window.location.href||e.config.disable_spa_query&&e.pathEquel())){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var i=e.getPopStateChangeEventData();e.sendPv(i)}}))},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){try{var e=this.storage.getItem(this.cache_key)||{},t=!1,i=this.storage.getItem("__tea_cache_first_"+this.appid);return t=!i||1!=i,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:e&&e.refer_manual_key||"",refer_page_title:e&&e.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+t}}catch(e){return this.collect.emit(k.DEBUGGER_MESSAGE,{type:k.DEBUGGER_MESSAGE_SDK,info:"something error",level:"error",time:Date.now(),data:e.message}),{}}},e.prototype.sendPv=function(e,t){this.collect.emit("route-change",{config:e,init:!1})},e.prototype.handleRefer=function(){var e="";try{var t=this.storage.getItem()||{};e=t.routeChange?t.refer_key:this.collect.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.setReferCache=function(e){var t=this.storage.getItem(this.cache_key)||{};t.refer_key=e,t.routeChange=!0,this.storage.setItem(this.cache_key,t)},e}();try{var Ne=W();Ne&&(Ne.LogRoute=function(e,t){(new Le).apply(e,t)})}catch(e){console.log(e)}var Pe=["getConfig","getAbSdkVersion"],Ve=["init","usePlugin","autoInitializationRangers","on"],Ke=function(){function e(e){this.task=[],this.newProcessTask=[],this.processMap=!1,this.Collector=e,this.collectMap=new Map,this.processMap=new Map,this.scopeList=new Map}return e.prototype.processTask=function(){var e,o,n=this;if(this.task.length){this.sliceScope(this.task);var r=function(e,t){var o=s.findIndex(t,Ve,"0");if(-1!==o){s.processMap.set(e,!0),s.processCmd.apply(s,i(t[o])),s.newProcessTask=t.filter((function(t){if("default"===e){if(-1===t[0].indexOf("."))return t}else if(-1!==t[0].indexOf(e+"."))return t}));var r=s.findIndex(s.newProcessTask,Ve,"0");s.newProcessTask.forEach((function(e,t){t!==r&&n.processCmd.apply(n,i(e))})),s.newProcessTask=[],s.scopeList.delete(e)}},s=this;try{for(var a=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}(this.scopeList),c=a.next();!c.done;c=a.next()){var l=t(c.value,2);r(l[0],l[1])}}catch(t){e={error:t}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(e)throw e.error}}this.task=[]}},e.prototype.processCmd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(s(e)){var i=this.processScope(e[0]),o=i.scope,n=i.cmd;if(!this.processMap.get(o))return this.task.push(e),void this.processTask();if(e.splice(0,1),-1!==Pe.indexOf(n))return this.callCmd(o,n,e);this.callCmd(o,n,e)}},e.prototype.callCmd=function(e,t,o){try{if(-1!==Ve.indexOf(t)&&(this.collectMap.get(e)||(this.collect=new this.Collector(e),this.collectMap.set(e,this.collect))),!this.collectMap.get(e))return void console.log("init or use must be first call, cmd:"+t);var n=this.collectMap.get(e);if(n&&n[t])if("event"===t)n.event.apply(n,i([t],o));else{if(-1!==Pe.indexOf(t))return n[t].apply(n,i(o));n[t].apply(n,i(o))}else n.event.apply(n,i([t],o))}catch(e){console.log(e.message)}},e.prototype.findIndex=function(e,t,i){var o=this,n=-1;try{e.forEach((function(e,r){var s=void 0!==i?e[i]:e,a=o.processScope(s).cmd;-1!==t.indexOf(a)&&(n=r)}))}catch(e){return n}return n},e.prototype.sliceScope=function(e){var t=this;e.forEach((function(e){var i=t.processScope(e[0]).scope;if(t.scopeList.get(i)){var o=t.scopeList.get(i);o.push(e),t.scopeList.set(i,o)}else t.scopeList.set(i,[e])}))},e.prototype.processScope=function(e){var t="default";try{if("string"==typeof e&&e.indexOf(".")>-1){var i=e.split(".");t=i[0],e=i[1]}}catch(i){return{scope:t,cmd:e}}return{scope:t,cmd:e}},e}();J.usePlugin(Ue,"extend"),J.usePlugin(Ce,"tracer"),J.usePlugin(X,"ab"),J.usePlugin(ee,"stay"),J.usePlugin(Ge,"autotrack"),J.usePlugin(Ie,"retry"),J.usePlugin(Y,"et"),J.usePlugin(ie,"heartbeat"),J.usePlugin(oe,"monitor"),J.usePlugin(Le,"route"),J.usePlugin(Ce,"tracer"),function(e){if("undefined"!=typeof window){var t=function(){if("undefined"!=typeof window)return window.LogAnalyticsObject||window.TeaAnalyticsObject}();if(t&&window[t]){var i=window[t];i.sdkLoad?console.log("you page has load sdk file already, do not load another sdk file"):(e.task=i.q||[],window[t]=e.processCmd.bind(e),window[t].sdkLoad=!0,e.processTask())}}}(new Ke(J))}();
